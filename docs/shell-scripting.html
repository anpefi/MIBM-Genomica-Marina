<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introducción al análisis bioinformático de secuencias NGS</title>
  <meta name="description" content="Guión de prácticas de la asignatura Genómica Marina del Máster Interuniversitario en Biología Marina">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Introducción al análisis bioinformático de secuencias NGS" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Guión de prácticas de la asignatura Genómica Marina del Máster Interuniversitario en Biología Marina" />
  <meta name="github-repo" content="anpefi/MIBM-Genomica-Marina" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introducción al análisis bioinformático de secuencias NGS" />
  
  <meta name="twitter:description" content="Guión de prácticas de la asignatura Genómica Marina del Máster Interuniversitario en Biología Marina" />
  

<meta name="author" content="Andrés Pérez-Figueroa">


<meta name="date" content="2018-04-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="analisis-de-datos-basico-con-la-shell.html">
<link rel="next" href="otras-consideraciones-importantes.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis Bioinformático NGS</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preparacion.html"><a href="preparacion.html"><i class="fa fa-check"></i>Preparación</a><ul>
<li class="chapter" data-level="" data-path="uso-de-una-imagen-docker-para-el-desarrollo-de-las-practicas.html"><a href="uso-de-una-imagen-docker-para-el-desarrollo-de-las-practicas.html"><i class="fa fa-check"></i>Uso de una imagen Docker para el desarrollo de las prácticas</a><ul>
<li class="chapter" data-level="" data-path="uso-de-una-imagen-docker-para-el-desarrollo-de-las-practicas.html"><a href="uso-de-una-imagen-docker-para-el-desarrollo-de-las-practicas.html#instalacion-de-docker"><i class="fa fa-check"></i>Instalación de Docker</a></li>
<li class="chapter" data-level="" data-path="uso-de-una-imagen-docker-para-el-desarrollo-de-las-practicas.html"><a href="uso-de-una-imagen-docker-para-el-desarrollo-de-las-practicas.html#ejecutar-el-contenedor-docker-del-curso"><i class="fa fa-check"></i>Ejecutar el contenedor Docker del curso</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="la-linea-de-comandos-unix.html"><a href="la-linea-de-comandos-unix.html"><i class="fa fa-check"></i><b>1</b> La línea de comandos UNIX</a><ul>
<li class="chapter" data-level="1.1" data-path="bash.html"><a href="bash.html"><i class="fa fa-check"></i><b>1.1</b> Bash</a></li>
<li class="chapter" data-level="1.2" data-path="por-que-usar-una-shell.html"><a href="por-que-usar-una-shell.html"><i class="fa fa-check"></i><b>1.2</b> ¿Por qué usar una Shell?</a></li>
<li class="chapter" data-level="1.3" data-path="cuales-son-los-conocimientos-minimos-que-deberia-adquirir-sobre-la-shell.html"><a href="cuales-son-los-conocimientos-minimos-que-deberia-adquirir-sobre-la-shell.html"><i class="fa fa-check"></i><b>1.3</b> ¿Cuales son los conocimientos mínimos que debería adquirir sobre la Shell?</a></li>
<li class="chapter" data-level="1.4" data-path="consideraciones-sobre-los-sistemas-linuxunix.html"><a href="consideraciones-sobre-los-sistemas-linuxunix.html"><i class="fa fa-check"></i><b>1.4</b> Consideraciones sobre los sistemas Linux/Unix</a><ul>
<li class="chapter" data-level="1.4.1" data-path="consideraciones-sobre-los-sistemas-linuxunix.html"><a href="consideraciones-sobre-los-sistemas-linuxunix.html#el-sistema-de-archivos"><i class="fa fa-check"></i><b>1.4.1</b> El sistema de archivos</a></li>
<li class="chapter" data-level="1.4.2" data-path="consideraciones-sobre-los-sistemas-linuxunix.html"><a href="consideraciones-sobre-los-sistemas-linuxunix.html#directorios-estandar"><i class="fa fa-check"></i><b>1.4.2</b> Directorios estándar</a></li>
<li class="chapter" data-level="1.4.3" data-path="consideraciones-sobre-los-sistemas-linuxunix.html"><a href="consideraciones-sobre-los-sistemas-linuxunix.html#nombres-de-archivos-en-linux"><i class="fa fa-check"></i><b>1.4.3</b> Nombres de archivos en Linux</a></li>
<li class="chapter" data-level="1.4.4" data-path="consideraciones-sobre-los-sistemas-linuxunix.html"><a href="consideraciones-sobre-los-sistemas-linuxunix.html#permisos-de-archivos-y-directorios"><i class="fa fa-check"></i><b>1.4.4</b> Permisos de archivos y directorios</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="comandos-basicos.html"><a href="comandos-basicos.html"><i class="fa fa-check"></i><b>1.5</b> Comandos básicos</a><ul>
<li class="chapter" data-level="1.5.1" data-path="comandos-basicos.html"><a href="comandos-basicos.html#ls"><i class="fa fa-check"></i><b>1.5.1</b> ls</a></li>
<li class="chapter" data-level="1.5.2" data-path="comandos-basicos.html"><a href="comandos-basicos.html#man"><i class="fa fa-check"></i><b>1.5.2</b> man</a></li>
<li class="chapter" data-level="1.5.3" data-path="comandos-basicos.html"><a href="comandos-basicos.html#cd"><i class="fa fa-check"></i><b>1.5.3</b> cd</a></li>
<li class="chapter" data-level="1.5.4" data-path="comandos-basicos.html"><a href="comandos-basicos.html#mkdir"><i class="fa fa-check"></i><b>1.5.4</b> mkdir</a></li>
<li class="chapter" data-level="1.5.5" data-path="comandos-basicos.html"><a href="comandos-basicos.html#touch"><i class="fa fa-check"></i><b>1.5.5</b> touch</a></li>
<li class="chapter" data-level="1.5.6" data-path="comandos-basicos.html"><a href="comandos-basicos.html#rm"><i class="fa fa-check"></i><b>1.5.6</b> rm</a></li>
<li class="chapter" data-level="1.5.7" data-path="comandos-basicos.html"><a href="comandos-basicos.html#un-inciso-sustitucion-de-nombres-de-archivo"><i class="fa fa-check"></i><b>1.5.7</b> Un inciso: sustitución de nombres de archivo</a></li>
<li class="chapter" data-level="1.5.8" data-path="comandos-basicos.html"><a href="comandos-basicos.html#cp"><i class="fa fa-check"></i><b>1.5.8</b> cp</a></li>
<li class="chapter" data-level="1.5.9" data-path="comandos-basicos.html"><a href="comandos-basicos.html#mv"><i class="fa fa-check"></i><b>1.5.9</b> mv</a></li>
<li class="chapter" data-level="1.5.10" data-path="comandos-basicos.html"><a href="comandos-basicos.html#lessmore"><i class="fa fa-check"></i><b>1.5.10</b> less/more</a></li>
<li class="chapter" data-level="1.5.11" data-path="comandos-basicos.html"><a href="comandos-basicos.html#cat"><i class="fa fa-check"></i><b>1.5.11</b> cat</a></li>
<li class="chapter" data-level="1.5.12" data-path="comandos-basicos.html"><a href="comandos-basicos.html#headtail"><i class="fa fa-check"></i><b>1.5.12</b> head/tail</a></li>
<li class="chapter" data-level="1.5.13" data-path="comandos-basicos.html"><a href="comandos-basicos.html#wc"><i class="fa fa-check"></i><b>1.5.13</b> wc</a></li>
<li class="chapter" data-level="1.5.14" data-path="comandos-basicos.html"><a href="comandos-basicos.html#el-editor-de-texto-nano"><i class="fa fa-check"></i><b>1.5.14</b> El editor de texto nano</a></li>
<li class="chapter" data-level="1.5.15" data-path="comandos-basicos.html"><a href="comandos-basicos.html#grep"><i class="fa fa-check"></i><b>1.5.15</b> grep</a></li>
<li class="chapter" data-level="1.5.16" data-path="comandos-basicos.html"><a href="comandos-basicos.html#redirecciones"><i class="fa fa-check"></i><b>1.5.16</b> Redirecciones</a></li>
<li class="chapter" data-level="1.5.17" data-path="comandos-basicos.html"><a href="comandos-basicos.html#cut"><i class="fa fa-check"></i><b>1.5.17</b> cut</a></li>
<li class="chapter" data-level="1.5.18" data-path="comandos-basicos.html"><a href="comandos-basicos.html#sort"><i class="fa fa-check"></i><b>1.5.18</b> sort</a></li>
<li class="chapter" data-level="1.5.19" data-path="comandos-basicos.html"><a href="comandos-basicos.html#uniq"><i class="fa fa-check"></i><b>1.5.19</b> uniq</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="descargar-contenido-online-con-wget.html"><a href="descargar-contenido-online-con-wget.html"><i class="fa fa-check"></i><b>1.6</b> Descargar contenido online con wget</a></li>
<li class="chapter" data-level="1.7" data-path="pipelines.html"><a href="pipelines.html"><i class="fa fa-check"></i><b>1.7</b> Pipelines</a></li>
<li class="chapter" data-level="1.8" data-path="compresion-de-archivos.html"><a href="compresion-de-archivos.html"><i class="fa fa-check"></i><b>1.8</b> Compresión de archivos</a></li>
<li class="chapter" data-level="1.9" data-path="analisis-de-datos-basico-con-la-shell.html"><a href="analisis-de-datos-basico-con-la-shell.html"><i class="fa fa-check"></i><b>1.9</b> Analisis de datos básico con la Shell</a></li>
<li class="chapter" data-level="1.10" data-path="shell-scripting.html"><a href="shell-scripting.html"><i class="fa fa-check"></i><b>1.10</b> Shell scripting</a></li>
<li class="chapter" data-level="1.11" data-path="otras-consideraciones-importantes.html"><a href="otras-consideraciones-importantes.html"><i class="fa fa-check"></i><b>1.11</b> Otras consideraciones importantes</a></li>
<li class="chapter" data-level="1.12" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i><b>1.12</b> Bibliografía</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="representacion-y-generacion-de-secuencias.html"><a href="representacion-y-generacion-de-secuencias.html"><i class="fa fa-check"></i><b>2</b> Representación y generación de secuencias</a><ul>
<li class="chapter" data-level="2.1" data-path="tipos-de-secuencias.html"><a href="tipos-de-secuencias.html"><i class="fa fa-check"></i><b>2.1</b> Tipos de secuencias</a></li>
<li class="chapter" data-level="2.2" data-path="formato-fasta.html"><a href="formato-fasta.html"><i class="fa fa-check"></i><b>2.2</b> Formato FASTA</a></li>
<li class="chapter" data-level="2.3" data-path="formato-fastq.html"><a href="formato-fastq.html"><i class="fa fa-check"></i><b>2.3</b> Formato FASTQ</a></li>
<li class="chapter" data-level="2.4" data-path="base-quality-scores.html"><a href="base-quality-scores.html"><i class="fa fa-check"></i><b>2.4</b> Base Quality scores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="procesado-de-lecturas-ngs.html"><a href="procesado-de-lecturas-ngs.html"><i class="fa fa-check"></i><b>3</b> Procesado de lecturas NGS</a><ul>
<li class="chapter" data-level="3.1" data-path="evaluacion-de-la-calidad.html"><a href="evaluacion-de-la-calidad.html"><i class="fa fa-check"></i><b>3.1</b> Evaluación de la calidad</a></li>
<li class="chapter" data-level="3.2" data-path="limpieza-de-lecturas.html"><a href="limpieza-de-lecturas.html"><i class="fa fa-check"></i><b>3.2</b> Limpieza de lecturas</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ensamblaje-genomico-de-novo.html"><a href="ensamblaje-genomico-de-novo.html"><i class="fa fa-check"></i><b>4</b> Ensamblaje genómico <em>de novo</em></a><ul>
<li class="chapter" data-level="4.1" data-path="evaluacion-del-ensamblaje.html"><a href="evaluacion-del-ensamblaje.html"><i class="fa fa-check"></i><b>4.1</b> Evaluación del ensamblaje</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mapeado.html"><a href="mapeado.html"><i class="fa fa-check"></i><b>5</b> Mapeado</a><ul>
<li class="chapter" data-level="5.1" data-path="formato-sam.html"><a href="formato-sam.html"><i class="fa fa-check"></i><b>5.1</b> Formato SAM</a></li>
<li class="chapter" data-level="5.2" data-path="formato-bam.html"><a href="formato-bam.html"><i class="fa fa-check"></i><b>5.2</b> Formato BAM</a></li>
<li class="chapter" data-level="5.3" data-path="mapear.html"><a href="mapear.html"><i class="fa fa-check"></i><b>5.3</b> Mapear</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="obtencion-de-elementos-genomicos.html"><a href="obtencion-de-elementos-genomicos.html"><i class="fa fa-check"></i><b>6</b> Obtención de elementos genómicos</a></li>
<li class="chapter" data-level="7" data-path="samtools-y-bedtools.html"><a href="samtools-y-bedtools.html"><i class="fa fa-check"></i><b>7</b> SAMtools y BEDtools</a></li>
<li class="chapter" data-level="8" data-path="herramientas-para-el-alineamiento-y-deteccion-de-variantes-en-secuencias-genomicas.html"><a href="herramientas-para-el-alineamiento-y-deteccion-de-variantes-en-secuencias-genomicas.html"><i class="fa fa-check"></i><b>8</b> Herramientas para el alineamiento y detección de variantes en secuencias genómicas</a></li>
<li class="chapter" data-level="9" data-path="obtencion-de-variantes.html"><a href="obtencion-de-variantes.html"><i class="fa fa-check"></i><b>9</b> Obtención de variantes</a></li>
<li class="chapter" data-level="" data-path="bibliografia-general.html"><a href="bibliografia-general.html"><i class="fa fa-check"></i>Bibliografía general</a></li>
<li class="chapter" data-level="" data-path="evaluacion.html"><a href="evaluacion.html"><i class="fa fa-check"></i>Evaluación</a></li>
<li class="divider"></li>
<li><a href="http://anpefi.eu/">Andrés Pérez Figueroa</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción al análisis bioinformático de secuencias NGS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="shell-scripting" class="section level2">
<h2><span class="header-section-number">1.10</span> Shell scripting</h2>
<p>Los scripts no son más que unos archivos que combinan diferentes comandos y pipelines con el fin de automatizarlos. En su formato más simple consisten en una serie de comandos escritos en líneas de texto. Por ejemplo consideremos el siguiente script guardado en el archivo <code>hello.sh</code></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="co"># comment</span>
<span class="bu">echo</span> Hello World</code></pre></div>
<p>La primera línea es de tipo especial y nos indica que shell debe usar (en este caso bash). La segunda línea, como va precedida de un “#” nos indica que es un comentario, no se va a ejecutar. Es muy importante comentar todos los pasos en un script. La tercera línea ya es un comando que se va a ejecutar.</p>
<p>Para ejecutar el script primero le damos permiso de ejecución <code>chmod +x hello.sh</code> y luego lo podemos ejecutar llamándolo por su ruta relativa (o la completa):</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">./hello.sh</span></code></pre></div>
<p>Ahora podemos escribir un script que automatize un análisis como el que hemos hecho antes para las features de <em>Crassotrea gigas</em> y guardarlo en un fichero oyster_features.sh</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="co"># script para el análisis de features del genoma de Crassostrea gigas</span>

<span class="co">#Creamos un nuevo directorio para este análisis</span>
<span class="bu">cd</span> ~/workdir
<span class="fu">mkdir</span> oyster
<span class="bu">cd</span> oyster

<span class="co">#Obtención de los datos</span>
<span class="fu">wget</span> -O oyster.gff.gz ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/297/895/GCF_000297895.1_oyster_v9/GCF_000297895.1_oyster_v9_genomic.gff.gz

<span class="co">#Descomprimimos</span>
<span class="fu">gunzip</span> oyster.gff.gz

<span class="co">#Obtenemos la tabla de features</span>
<span class="fu">cat</span> oyster.gff <span class="kw">|</span> <span class="fu">grep</span> -v -e <span class="st">&quot;^#&quot;</span> <span class="kw">|</span> <span class="fu">cut</span> -f3 <span class="kw">|</span>  <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> -c <span class="kw">|</span> <span class="fu">sort</span></code></pre></div>
<p>Ahora podemos correr ese script, pero en vez de que nos muestre la tabla de features, que nos la guarde en un fichero llamado oyster_features.txt</p>
<pre><code>cd ~/workdir
chmod +x oyster_features.sh
./oyster_features.sh &gt; oyster_features.txt</code></pre>
<p>Ahora ya tenemos nuestro análisis básico totalmente automatizado en un script. Tiene la ventaja de que es fácilmente editable para hacer lo mismo con otros ficheros de datos.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-20" class="exercise"><strong>Ejercicio 1.20  </strong></span>Modifica el script para hacer el mismo análisis en <em>Anguilla anguilla</em> (busca el gff en <a href="https://www.ncbi.nlm.nih.gov/genome/10841?genome_assembly_id=59496" class="uri">https://www.ncbi.nlm.nih.gov/genome/10841?genome_assembly_id=59496</a>). ¿Cual es el resultado?¿Qué ha podido pasar?
</div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="analisis-de-datos-basico-con-la-shell.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="otras-consideraciones-importantes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["genomica.pdf"],
"toc": {
"collapse": "subsection"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
